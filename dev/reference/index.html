<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Reference · Analytical MK approach</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Analytical MK approach</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../package/">Package overview</a></li><li class="is-active"><a class="tocitem" href>Reference</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Analytical-estimation-1"><span>Analytical estimation</span></a></li><li><a class="tocitem" href="#Fixations-1"><span>Fixations</span></a></li><li><a class="tocitem" href="#Polymorphism-1"><span>Polymorphism</span></a></li><li><a class="tocitem" href="#Summary-statistics-1"><span>Summary statistics</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Reference</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/jmurga/Analytical.jl/blob/master/docs/src/reference.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="*adap*-variable-1"><a class="docs-heading-anchor" href="#*adap*-variable-1"><em>adap</em> variable</a><a class="docs-heading-anchor-permalink" href="#*adap*-variable-1" title="Permalink"></a></h1><p><em>adap</em> is the only variable exported from <em>Analytical</em> module. It is a Mutable structure contaning the variables required to solve the 4 analytical approach. Any value could be easily change reassing. <em>adap</em> should be change before the execution, in other case, <span>$\alpha_{(x)$</span> will be solve with the default values. To change all the values at once, you can use <a href="@ref Analytical.changeParameters">Analytical.changeParameters</a> in order to set a model.</p><article class="docstring"><header><a class="docstring-binding" id="Analytical.adap" href="#Analytical.adap"><code>Analytical.adap</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia">adap( 
	gam_neg::Int64,
	gL::Int64,	
	gH::Int64,
	alLow::Float64,
	alTot::Float64,
	theta_f::Float64,
	theta_mid_neutral::Float64,
	al::Float64,
	be::Float64,
	B::Float64,
	bRange::Array{Float64,1}
	pposL::Float64,
	pposH::Float64,
	N::Int64,
	n::Int64,
	Lf::Int64,
	rho::Float64,
	TE::Float64,
)</code></pre><p>Mutable structure containing the variables required to solve the analytical approach. All the functions are solve using the internal values of the structure. For this reason, <em>adap</em> is the only exported variable. Adap should be change before the perform the analytical approach, in other case, <code>$\alpha_{(x)}$</code> will be solve with the default values.</p><p><strong>Parameters</strong></p><ul><li><code>gam_neg::Int64</code>: </li><li><code>gL::Int64</code>: </li><li><code>gH::Int64</code>: </li><li><code>alLow::Float64</code>: </li><li><code>alTot::Float64</code>: </li><li><code>theta_f::Float64</code>: </li><li><code>theta_mid_neutral::Float64</code>: </li><li><code>al::Float64</code>: </li><li><code>be::Float64</code>: </li><li><code>B::Float64</code>: </li><li><code>bRange::Array{Float64,1}</code>:</li><li><code>pposL::Float64</code>: </li><li><code>pposH::Float64</code>: </li><li><code>N::Int64</code>: </li><li><code>n::Int64</code>: </li><li><code>Lf::Int64</code>: </li><li><code>rho::Float64</code>: </li><li><code>TE::Float64</code>: </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jmurga/Analytical.jl/blob/25021e20a2a7b3b46746049c4794c735a9a7d7d3/src/parameters.jl#L31-L75">source</a></section></article><h1 id="Analytical-estimation-1"><a class="docs-heading-anchor" href="#Analytical-estimation-1">Analytical estimation</a><a class="docs-heading-anchor-permalink" href="#Analytical-estimation-1" title="Permalink"></a></h1><h2 id="Fixations-1"><a class="docs-heading-anchor" href="#Fixations-1">Fixations</a><a class="docs-heading-anchor-permalink" href="#Fixations-1" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Analytical.fixNeut" href="#Analytical.fixNeut"><code>Analytical.fixNeut</code></a> — <span class="docstring-category">Function</span></header><section><div><ul><li>fixNeut()</li></ul><p>Expected neutral fixations rate reduce by a background selection value.</p><div>\[\mathbb{E}[D_{s}] = (1 - p_{-} - p_{+}) B \frac{1}{2N}\]</div><p><strong>Returns</strong></p><ul><li><code>Float64</code>: expected rate of neutral fixations.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jmurga/Analytical.jl/blob/25021e20a2a7b3b46746049c4794c735a9a7d7d3/src/fixations.jl#L9-L21">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Analytical.fixNegB" href="#Analytical.fixNegB"><code>Analytical.fixNegB</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">fixNegB(ppos)</code></pre><p>Expected fixation rate from negative DFE.</p><div>\[\mathbb{E}[D_{n-}] =  p_{-}\left(2^-\alpha\beta^\alpha\left(-\zeta[\alpha,\frac{2+\beta}{2}] + \zeta[\alpha,1/2(2-\frac{1}{N+\beta})]\right)\right)\]</div><p><strong>Arguments</strong></p><ul><li><code>ppos::Float64</code>: selection coefficient.</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: expected rate of fixations from negative DFE.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jmurga/Analytical.jl/blob/25021e20a2a7b3b46746049c4794c735a9a7d7d3/src/fixations.jl#L28-L44">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Analytical.pFix" href="#Analytical.pFix"><code>Analytical.pFix</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">pFix()</code></pre><p>Expected positive fixation rate.</p><div>\[\mathbb{E}[D_{n+}] =  p_{+} \cdot B \cdot (1 - e^{(-2s)})\]</div><p><strong>Arguments</strong></p><ul><li><code>ppos::Float64</code>: selection coefficient.</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: expected rate of positive fixation.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jmurga/Analytical.jl/blob/25021e20a2a7b3b46746049c4794c735a9a7d7d3/src/fixations.jl#L51-L66">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Analytical.fixPosSim" href="#Analytical.fixPosSim"><code>Analytical.fixPosSim</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">fixPosSim(gamma,ppos)</code></pre><p>Expected positive fixations rate reduced due to the impact of background selection and linkage. The probabilty of fixation of positively selected alleles is reduced by a factor Φ across all deleterious linked sites <a href="@ref"><code>Analytical.phiReduction</code></a>.</p><div>\[\mathbb{E}[D_{n+}] =  \Phi \cdot \mathbb{E}[D_{n+}]\]</div><p><strong>Arguments</strong></p><ul><li><code>ppos::Float64</code>: selection coefficient</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: expected rate of positive fixations under background selection</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jmurga/Analytical.jl/blob/25021e20a2a7b3b46746049c4794c735a9a7d7d3/src/fixations.jl#L86-L102">source</a></section></article><h2 id="Polymorphism-1"><a class="docs-heading-anchor" href="#Polymorphism-1">Polymorphism</a><a class="docs-heading-anchor-permalink" href="#Polymorphism-1" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Analytical.DiscSFSNeutDown" href="#Analytical.DiscSFSNeutDown"><code>Analytical.DiscSFSNeutDown</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">DiscSFSNeutDown()</code></pre><p>Expected rate of neutral allele frequency reduce by background selection. The spectrum depends on the number of individual []</p><div>\[\mathbb{E}[Ps_{(x)}] = \sum{x^{*}=x}{x^{*}=1}f_{B}(x)\]</div><p><strong>Return:</strong></p><ul><li><code>Array{Float64}</code>: expected rate of neutral alleles frequencies.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jmurga/Analytical.jl/blob/25021e20a2a7b3b46746049c4794c735a9a7d7d3/src/polymorphism.jl#L11-L23">source</a></section></article><h2 id="Summary-statistics-1"><a class="docs-heading-anchor" href="#Summary-statistics-1">Summary statistics</a><a class="docs-heading-anchor-permalink" href="#Summary-statistics-1" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Analytical.poissonFixation" href="#Analytical.poissonFixation"><code>Analytical.poissonFixation</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">poissonFixation(observedValues,λds, λdn)</code></pre><p>Divergence sampling from Poisson distribution. The expected neutral and selected fixations are subset through their relative expected rates (<a href="#Analytical.fixNeut"><code>Analytical.fixNeut</code></a>, <a href="#Analytical.fixNegB"><code>Analytical.fixNegB</code></a>, <a href="#Analytical.fixPosSim"><code>Analytical.fixPosSim</code></a>). Empirical values are used are used to simulate the locus <em>L</em> along a branch of time <em>T</em> from which the expected <em>Ds</em> and <em>Dn</em> raw count estimated given the mutation rate (<span>$\mu$</span>). Random number generation is used to subset samples arbitrarily given the success rate <span>$\lambda$</span> in the distribution.</p><p><strong>Arguments</strong></p><ul><li><code>observedValues::Array{Int64,1}</code>: Array containing the total observed divergence.</li><li><code>λds</code>: expected neutral fixations rate.</li><li><code>λdn</code>: expected selected fixations rate.</li></ul><p><strong>Returns</strong></p><ul><li><code>Array{Int64,1}</code> containing the expected count of neutral and selected fixations.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jmurga/Analytical.jl/blob/25021e20a2a7b3b46746049c4794c735a9a7d7d3/src/summaryStatistics.jl#L4-L16">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Analytical.poissonPolymorphism" href="#Analytical.poissonPolymorphism"><code>Analytical.poissonPolymorphism</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">poissonPolymorphism(observedValues,λps,λpn)</code></pre><p>Polymorphism sampling from Poisson distributions. The total expected neutral and selected polimorphism are subset through the relative expected rates at the frequency spectrum (<a href="#Analytical.fixNeut"><code>Analytical.fixNeut</code></a>, <a href="#Analytical.DiscSFSNeutDown"><code>Analytical.DiscSFSNeutDown</code></a>,). Empirical sfs are used to simulate the locus <em>L</em> along a branch of time <em>T</em> from which the expected <em>Ps</em> and <em>Pn</em> raw count are estimated given the mutation rate (<span>$\mu$</span>). Random number generation is used to subset samples arbitrarily from the whole sfs given each frequency success rate <span>$\lambda$</span> in the distribution.</p><p><strong>Arguments</strong></p><ul><li><code>observedValues::Array{Int64,1}</code>: Array containing the total observed divergence.</li><li><code>λps</code>: expected neutral site frequency spectrum rate.</li><li><code>λpn</code>: expected selected site frequency spectrum rate.</li></ul><p><strong>Returns</strong></p><ul><li><code>Array{Int64,1}</code> containing the expected total count of neutral and selected polymorphism.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jmurga/Analytical.jl/blob/25021e20a2a7b3b46746049c4794c735a9a7d7d3/src/summaryStatistics.jl#L28-L40">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Analytical.alphaByFrequencies" href="#Analytical.alphaByFrequencies"><code>Analytical.alphaByFrequencies</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">alphaByFrequencies(gammaL,gammaH,pposL,pposH,observedData,nopos)</code></pre><p>Analytical α(x) estimation. We used the expected rates of divergence and polymorphism to approach the asympotic value accouting for background selection, weakly and strong positive selection. α(x) can be estimated taking into account the role of positive selected alleles or not. We solve α(x) from empirical observed values. The values will be use to sample from a Poisson distribution the total counts of polymorphism and divergence using the rates. The mutation rate, the locus length and the time of the branch should be proportional to the observed values. </p><div>\[\mathbb{E}[\alpha_{x}] =  1 - \left(\frac{\mathbb{E}[D_{s}]}{\mathbb{E}[D_{N}]}\frac{\mathbb{E}[P_{N}]}{\mathbb{E}[P_{S}]}\right)\]</div><p><strong>Arguments</strong></p><ul><li><code>gammaL::Int64</code>: strength of weakly positive selection</li><li><code>gammaH::Int64</code>: strength of strong positive selection</li><li><code>pposL</code>::Float64: probability of weakly selected allele</li><li><code>pposH</code>::Float64: probability of strong selected allele</li><li><code>observedData::Array{Any,1}</code>: Array containing the total observed divergence, polymorphism and site frequency spectrum.</li><li><code>nopos::String(&quot;pos&quot;,&quot;nopos&quot;,&quot;both&quot;)</code>: string to perform α(x) account or not for both positive selective alleles.</li></ul><p><strong>Returns</strong></p><ul><li><code>Tuple{Array{Float64,1},Array{Float64,2}}</code> containing α(x) and the summary statistics array (Ds,Dn,Ps,Pn,α).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jmurga/Analytical.jl/blob/25021e20a2a7b3b46746049c4794c735a9a7d7d3/src/summaryStatistics.jl#L141-L160">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../package/">« Package overview</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 19 May 2020 10:53">Tuesday 19 May 2020</span>. Using Julia version 1.0.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
