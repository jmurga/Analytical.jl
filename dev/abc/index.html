<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>ABC inference from empirical data · ABC-MK</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">ABC-MK</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href><em>ABC</em> inference from empirical data</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href><em>ABC</em> inference from empirical data</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/jmurga/Analytical.jl/blob/master/docs/src/abc.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="*ABC*-inference-from-empirical-data-1"><a class="docs-heading-anchor" href="#*ABC*-inference-from-empirical-data-1"><em>ABC</em> inference from empirical data</a><a class="docs-heading-anchor-permalink" href="#*ABC*-inference-from-empirical-data-1" title="Permalink"></a></h1><h2 id="Prior-distributions-from-analytical-estimations-1"><a class="docs-heading-anchor" href="#Prior-distributions-from-analytical-estimations-1">Prior distributions from analytical estimations</a><a class="docs-heading-anchor-permalink" href="#Prior-distributions-from-analytical-estimations-1" title="Permalink"></a></h2><p>In this example we provide a solution to replicate results at <a href="https://doi.org/10.1038/s41559-019-0890-6">Uricchio et al. 2019</a>. We will simulate <span>$10^6$</span> summary statistics from random <em>DFE</em> to use as prior distribution in <em>ABCreg</em>. In this case we will need a set of empirical observed values in order to subset the summary statistics.</p><p>We need to set the model accounting for the sampling value. The <em>SFS</em> is expected to be in raw frequencies. If the model is not properly set up, the <em>SFS</em> will not be correctly parsed. In our case, we are going to set up a model with default parameters only to parse the <em>SFS</em> and convolute the observed frequencies with a binomial distribution.</p><pre><code class="language-julia">using Analytical
adap = Analytical.parameters(N=1000,n=661)</code></pre><p>Once the model account for the number of samples we can open the files. The function <code>Analytical.parseSfs</code> will return polymorphic and divergent counts and SFS accounting for the whole spectrum: <code>collect(1:adap.nn)/adap.nn</code>. In addition an output file will be created contained the observed values to input in <em>ABCreg</em>.</p><pre><code class="language-julia"></code></pre><p>The module include a function to solve <em>N</em> times different genetic scenarios. We solve the analytical approximation taking into account random and independent values to draw <em>DFE</em> and <span>$\alpha_{(x)}$</span>. Each parameter combination are replicated to 5% frequency bins background selection values (saved at <code>adap.bRange</code>).</p><pre><code class="language-julia"># Execute one to compile the function</code></pre><p>To parallelize the process we created a thread pool inside <a href="@ref"><code>summaryStats</code></a> using the <em>Distributed</em> package. To parallel the process you only need to define the available process and add our model to each thread.</p><pre><code class="language-julia"># Load Distributed package and add threads

# Load the pacakgein all the threads</code></pre><p>Alternatively, if you are going to use the command line script, please make the threads available when executing julia</p><pre><code class="language-bash"></code></pre><h2 id="*ABC*-inference-1"><a class="docs-heading-anchor" href="#*ABC*-inference-1"><em>ABC</em> inference</a><a class="docs-heading-anchor-permalink" href="#*ABC*-inference-1" title="Permalink"></a></h2><p>Generic ABC methods proceed by three main steps: (1) first sampling parameter values from prior distributions, (2) next simulating a model and calculating informative summary statistics, and lastly (3) comparing the simulated summary statistics to observed data. The parameter values that produce summary statistics that best match the observed data form an approximate posterior distribution. We link Julia with <em>ABCreg</em>. It will output one file per line in data. The files contain the posterior distributions. We return the posterior distributions, mean and quantiles.</p><p>You can easily plot the posterior distributions using Julia or just input the files at your favorite plot software.</p><p><a href="https://nbviewer.jupyter.org/github/jmurga/Analytical.jl/blob/master/scripts/analyticalAlphaAndPriors.ipynb"><img src="https://img.shields.io/badge/render-nbviewer-orange.svg" alt="NBViewer"/></a></p></article></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Sunday 14 February 2021 18:26">Sunday 14 February 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
