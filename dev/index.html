<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · Analytical MK approach</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Analytical MK approach</span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Installation-1"><span>Installation</span></a></li><li><a class="tocitem" href="#Dependencies-1"><span>Dependencies</span></a></li><li><a class="tocitem" href="#References-1"><span>References</span></a></li></ul></li><li><span class="tocitem">Package Overview</span><ul><li><a class="tocitem" href="analytical/">Analytical estimations</a></li><li><a class="tocitem" href="abc/">ABC inference</a></li></ul></li><li><a class="tocitem" href="reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/jmurga/Analytical.jl/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="ABC-MK-1"><a class="docs-heading-anchor" href="#ABC-MK-1">ABC-MK</a><a class="docs-heading-anchor-permalink" href="#ABC-MK-1" title="Permalink"></a></h1><p>ABC-MK is an analytical approximation to <span>$\alpha_{x}$</span>. We explore the impact of linkage and background selection at positive selected alleles sites. The package solves anylitical approximations for different genetic scenarios in order to estimate the strenght and rate of adaptation. </p><p>When empircal values of polymorphim and divergence are given, they will be used to discern their expected correspoding values modeled under any Distribution of Fitness Effect (<em>DFE</em>) and background selection values (<em>B</em>). </p><p>Our goal is to subset summary statistics given empirical observed values that would be used as prior distributions in <em>ABC</em> algorithms. Please check</p><h2 id="Installation-1"><a class="docs-heading-anchor" href="#Installation-1">Installation</a><a class="docs-heading-anchor-permalink" href="#Installation-1" title="Permalink"></a></h2><p>To install our module we highly recommend to use <a href="https://julialang.org/downloads/">LTS official Julia binaries</a>. If is your first time using Julia, you can easily export the Julia bin through <code>export PATH=&quot;/path/to/directory/julia-1.v.v/bin:$PATH&quot;</code> in your shell. Since we use <em>scipy</em> to solve equations, the package depends on PyCall.</p><pre><code class="language-bash">julia -e &#39;using Pkg;Pkg.add(PackageSpec(path=&quot;https://github.com/jmurga/Analytical.jl&quot;))&#39;</code></pre><p>Or from Pkg REPL (by pressing <code>]</code> at Julia interpreter):</p><pre><code class="language-julia">add https://github.com/jmurga/Analytical.jl</code></pre><p><strong>Scipy installation</strong>  </p><p>You can install <em>scipy</em> on your default Python or install it through Julia Conda:</p><pre><code class="language-julia">julia -e &#39;using Pkg;Pkg.add(&quot;PyCall&quot;);using PyCall;pyimport_conda(&quot;scipy.optimize&quot;, &quot;scipy&quot;)&#39;</code></pre><p>If you cannot install properly <em>scipy</em> through Julia Conda try the following:</p><ul><li>Set an empty Python enviroment and re-build PyCall: <code>ENV[&quot;PYTHON&quot;]=&quot;&quot;;  Pkg.build(&quot;PyCall&quot;)</code></li><li>Re-launch Julia and install the scipy.optimize module: <code>using PyCall;pyimport_conda(&quot;scipy.optimize&quot;, &quot;scipy)</code></li></ul><h3 id="Docker-1"><a class="docs-heading-anchor" href="#Docker-1">Docker</a><a class="docs-heading-anchor-permalink" href="#Docker-1" title="Permalink"></a></h3><p>We provide a Docker image based on Debian including Julia and Jupyter notebook. You can access to Debian system or just to Jupyter pulling the image from dockerhub. Remember to link the folder <code>/analysis</code> with any folder at your home to save the results:</p><pre><code class="language-bash"># Pull the image
docker pull jmurga/mktest
# Run docker bash interactive session linking to some local volume to export data. 
docker run -i -t -v ${HOME}/folderPath:/analysis/folder  jmurga/mktest
# Run only jupyter notebook from docker image. Change the port if 8888 is already used
docker run -i -t -v ${HOME}/folderPath:/analysis/folder -p 8888:8888 jmurga/mktest /bin/bash -c &quot;jupyter-lab --ip=&#39;*&#39; --port=8888 --no-browser --allow-root&quot;</code></pre><h2 id="Dependencies-1"><a class="docs-heading-anchor" href="#Dependencies-1">Dependencies</a><a class="docs-heading-anchor-permalink" href="#Dependencies-1" title="Permalink"></a></h2><p>All the dependecies are installed within the package. You don&#39;t need to install manually. If you experiment any problem contact us or try to reinstall <em>Pycall</em> and <em>scipy</em>.</p><h4 id="Mandatory-dependencies-to-solve-the-analytical-equations-1"><a class="docs-heading-anchor" href="#Mandatory-dependencies-to-solve-the-analytical-equations-1">Mandatory dependencies to solve the analytical equations</a><a class="docs-heading-anchor-permalink" href="#Mandatory-dependencies-to-solve-the-analytical-equations-1" title="Permalink"></a></h4><ul><li><a href="https://github.com/JuliaMath/Roots.jl"><code>Roots</code></a> - root finding.</li><li><a href="https://github.com/JuliaStats/Distributions.jl"><code>Distributions</code></a> - probability distributions.</li><li><a href="https://github.com/JuliaPy/PyCall.jl"><code>PyCall</code></a> - directly call and fully interoperate with Python.</li><li><a href="https://github.com/JuliaMath/SpecialFunctions.jl"><code>SpecialFunctions</code></a> - special mathematical functions in Julia.</li><li><a href="https://github.com/mauro3/Parameters.jl"><code>Parameters</code></a> - custom keyword constructor.</li></ul><h4 id="The-following-dependencies-are-required-to-use-all-the-funcionalities-(parse-SFS,-plots,-etc.)-1"><a class="docs-heading-anchor" href="#The-following-dependencies-are-required-to-use-all-the-funcionalities-(parse-SFS,-plots,-etc.)-1">The following dependencies are required to use all the funcionalities (parse SFS, plots, etc.)</a><a class="docs-heading-anchor-permalink" href="#The-following-dependencies-are-required-to-use-all-the-funcionalities-(parse-SFS,-plots,-etc.)-1" title="Permalink"></a></h4><ul><li><a href="https://github.com/JuliaNLSolvers/Optim.jl"><code>CSV</code></a></li><li><a href="https://github.com/JuliaStats/Distributions.jl"><code>Parsers</code></a></li><li><a href="https://github.com/JuliaStats/Distances.jl"><code>StatsBase</code></a></li><li><a href="https://github.com/JuliaStats/Distances.jl"><code>DataFrames</code></a></li><li><a href="https://github.com/JuliaIO/GZip.jl"><code>GZip</code></a></li></ul><h4 id="ABC-1"><a class="docs-heading-anchor" href="#ABC-1">ABC</a><a class="docs-heading-anchor-permalink" href="#ABC-1" title="Permalink"></a></h4><p>We link <a href="https://github.com/molpopgen/ABCreg">ABCreg</a> with julia in order to perform ABC estimations. If you are going to use ABCreg to do inference please <a href="https://doi.org/10.1186/1471-2156-10-35">cite the publication</a> and compile it in your system. Anyway, once you get the priors distributions you can use any other ABC software.</p><pre><code class="language-bash">git clone https://github.com/molpopgen/ABCreg.git
cd ABCreg/src &amp;&amp; make</code></pre><h2 id="References-1"><a class="docs-heading-anchor" href="#References-1">References</a><a class="docs-heading-anchor-permalink" href="#References-1" title="Permalink"></a></h2></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="analytical/">Analytical estimations »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 21 May 2020 09:05">Thursday 21 May 2020</span>. Using Julia version 1.0.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
