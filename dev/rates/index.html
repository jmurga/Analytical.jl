<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Rates · ABC-MK</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">ABC-MK</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Package Overview</span><ul><li><a class="tocitem" href="../analytical/">Analytical estimations</a></li><li><a class="tocitem" href="../data/">Processing data</a></li><li><a class="tocitem" href="../mk/">MK approaches</a></li></ul></li><li><span class="tocitem">Infering the rate and strength of adaptation</span><ul><li><a class="tocitem" href="../empirical/">Empirical estimation</a></li><li class="is-active"><a class="tocitem" href>Rates</a></li><li><a class="tocitem" href="../input/">Input data</a></li><li><a class="tocitem" href="../summstat/">Summary statistics</a></li><li><a class="tocitem" href="../abc/">ABC inference</a></li></ul></li><li><a class="tocitem" href="../cli/">Command-Line interface</a></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Infering the rate and strength of adaptation</a></li><li class="is-active"><a href>Rates</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Rates</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/jmurga/Analytical.jl/blob/master/docs/src/rates.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Estimating-fixation-and-polymorphic-rates-considering-generalized-model-of-selection-and-linkage-1"><a class="docs-heading-anchor" href="#Estimating-fixation-and-polymorphic-rates-considering-generalized-model-of-selection-and-linkage-1">Estimating fixation and polymorphic rates considering generalized model of selection and linkage</a><a class="docs-heading-anchor-permalink" href="#Estimating-fixation-and-polymorphic-rates-considering-generalized-model-of-selection-and-linkage-1" title="Permalink"></a></h1><p>Before executing the rate estimation, you need to load <em>Distributed</em> module and add some threads</p><pre><code class="language-julia">using Distributed
addprocs(7)</code></pre><p>Then you need to declare the <code>Analytical</code> module in all the threads using <code>@everywhere</code> macro. Otherwise, the <code>Analytical</code> module will perform the estimation just using the main core</p><pre><code class="language-julia">@everywhere using Analytical, ParallelUtilites
using CSV, DataFrames, JLD2, ProgressMeter</code></pre><p>Declare a variable containing some basic information about your model. We used a sample size of 661 to perform later analysis over TGP data. The selected Derived Alleles Counts (dac) will be used to compute summary statistics and perform ABC inference</p><pre><code class="language-julia">adap              = Analytical.parameters(n=661,dac=[1,2,4,5,10,20,50,100,200,400,500,661,925,1000], al=0.184)
convolutedSamples = Analytical.binomialDict()
Analytical.binomOp!(adap,convolutedSamples.bn)</code></pre><p>The function <code>Analytical.rates</code> will perform the analytical estimation of <em>N</em> independent models regarding DFE, BGS, mutation rate, and recombination rate. In the following example, we declared the prior distribution for each model parameter. We show how to compute summary statistics in the following section</p><p>Note that <a href="@ref"><code>Analytical.rates</code></a> is the most resource and time-consuming function. In our case, the function will estimate 10^5 independent models. Each model solves the estimation for all possible BGS values. We used BGS values from 0.1 to 0.999 in 5% increments. In total, the example will produce 3.7 million estimates. We have used a hierarchical data structure (HDF5) to facilitate model parameters and rates storage.</p><p>The following example took about 1.5 hours to execute on the hardware described at section <a href="../empirical/">Infering the rate and strength of adaptation</a></p><pre><code class="language-julia">@time df = Analytical.rates(param = adap,convolutedSamples=convolutedSamples,gH=collect(200:2000),gL=collect(1:10),gamNeg=collect(-2000:-200),iterations = 10^5,shape=adap.al,output=&quot;${HOME}/rates.jld2&quot;,);</code></pre><p>If you have a system with few resources, it is possible <a href="https://imkt.uab.cat/files/inputs/rates.jld2">to download pre-computed TGP and DGN data rates</a>. Please go to the next section to continue the inference using the pre-computed rates.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../empirical/">« Empirical estimation</a><a class="docs-footer-nextpage" href="../input/">Input data »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 11 May 2021 17:26">Tuesday 11 May 2021</span>. Using Julia version 1.6.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
